{"editor":{"id":"d382f8e3-98ad-4c47-86d5-009490e7dd47","locked":false,"offsetX":-26,"offsetY":-16,"zoom":100,"gridSize":0,"layers":[{"id":"d9ea5933-0004-4f0d-a8c0-290a2c9849f2","type":"diagram-links","isSvg":true,"transformed":true,"models":{"a1943797-3da8-4969-ac1c-9cc84c8d37cd":{"id":"a1943797-3da8-4969-ac1c-9cc84c8d37cd","type":"default","selected":false,"source":"9642adda-63d5-4e10-b22a-f05baea64a25","sourcePort":"0b717715-3582-41bc-9da8-ca64ef906f71","target":"66671773-167a-418d-b882-2abe13d1c849","targetPort":"17263d40-b06e-4879-996d-2d52927d5ad3","points":[{"id":"06c3a143-4475-4b80-ba27-d848cc65ac7b","type":"point","x":388.5,"y":563.5},{"id":"b0e5f12e-836d-44bb-9dec-14161e11aeb2","type":"point","x":555.5,"y":575.5}],"labels":[],"width":3,"color":"gray","curvyness":50,"selectedColor":"rgb(0,192,255)"},"84af1677-8c1d-479c-aed0-fa83a7fe48ba":{"id":"84af1677-8c1d-479c-aed0-fa83a7fe48ba","type":"default","selected":false,"source":"0005-1ef4ad68-5036-4b35-8f12-a38ac993841e","sourcePort":"1c2a5cab-315e-4e9e-b074-6b8ae69ebb57","target":"66671773-167a-418d-b882-2abe13d1c849","targetPort":"fea8dc5a-ef86-4913-9365-b95fe1bad698","points":[{"id":"60d9d948-4155-448f-93c3-2532c4439674","type":"point","x":902,"y":141.5},{"id":"5d0ef1de-973e-4ba2-8a50-e9e2da71c4a4","type":"point","x":842.453125,"y":312.5}],"labels":[],"width":3,"color":"gray","curvyness":50,"selectedColor":"rgb(0,192,255)"},"a613f538-eabd-40f1-bb88-ebd101562443":{"id":"a613f538-eabd-40f1-bb88-ebd101562443","type":"default","selected":false,"source":"66671773-167a-418d-b882-2abe13d1c849","sourcePort":"40de1718-45ce-4ce6-9053-4041f799d06d","target":"db0cd39e-e53a-4579-95f7-b652803a8bab","targetPort":"c68d9144-0e42-4725-baab-ab9ce7cef65d","points":[{"id":"5544382d-c461-4f08-bfe2-ed9e7f153d8a","type":"point","x":1129.40625,"y":575.5},{"id":"bba4ebfc-8aee-453c-84b1-2b6c01a5bc37","type":"point","x":1452.5,"y":440.5}],"labels":[],"width":3,"color":"gray","curvyness":50,"selectedColor":"rgb(0,192,255)"}}},{"id":"60dbdf23-d7e9-45a9-a943-4282f6ee3c51","type":"diagram-nodes","isSvg":false,"transformed":true,"models":{"9642adda-63d5-4e10-b22a-f05baea64a25":{"id":"9642adda-63d5-4e10-b22a-f05baea64a25","type":"basic.input","selected":false,"x":295,"y":537,"ports":[{"id":"0b717715-3582-41bc-9da8-ca64ef906f71","type":"port.output","x":381,"y":556,"name":"input-out","alignment":"right","parentNode":"9642adda-63d5-4e10-b22a-f05baea64a25","links":["a1943797-3da8-4969-ac1c-9cc84c8d37cd"],"in":false,"label":"Enable","hideLabel":true}],"data":{"name":"Enable"}},"0005-1ef4ad68-5036-4b35-8f12-a38ac993841e":{"id":"0005-1ef4ad68-5036-4b35-8f12-a38ac993841e","type":"basic.constant","selected":true,"x":840,"y":25,"ports":[{"id":"1c2a5cab-315e-4e9e-b074-6b8ae69ebb57","type":"port.output","x":894.5,"y":134,"name":"constant-out","alignment":"bottom","parentNode":"0005-1ef4ad68-5036-4b35-8f12-a38ac993841e","links":["84af1677-8c1d-479c-aed0-fa83a7fe48ba"],"in":false,"label":"ROSTopic","hideLabel":true}],"data":{"name":"ROSTopic","value":"/odom","local":true}},"66671773-167a-418d-b882-2abe13d1c849":{"id":"66671773-167a-418d-b882-2abe13d1c849","type":"basic.code","selected":false,"x":547,"y":235,"ports":[{"id":"17263d40-b06e-4879-996d-2d52927d5ad3","type":"port.input","x":548,"y":568,"name":"Enable","alignment":"left","parentNode":"66671773-167a-418d-b882-2abe13d1c849","links":["a1943797-3da8-4969-ac1c-9cc84c8d37cd"],"in":true,"label":"Enable","hideLabel":false},{"id":"40de1718-45ce-4ce6-9053-4041f799d06d","type":"port.output","x":1121.90625,"y":568,"name":"X-Y-Yaw","alignment":"right","parentNode":"66671773-167a-418d-b882-2abe13d1c849","links":["a613f538-eabd-40f1-bb88-ebd101562443"],"in":false,"label":"X-Y-Yaw","hideLabel":false},{"id":"fea8dc5a-ef86-4913-9365-b95fe1bad698","type":"port.parameter","x":834.953125,"y":305,"name":"ROSTopic","alignment":"top","parentNode":"66671773-167a-418d-b882-2abe13d1c849","links":["84af1677-8c1d-479c-aed0-fa83a7fe48ba"],"in":true,"label":"ROSTopic","hideLabel":false}],"data":{"code":"#!/usr/bin/env python3\n\nimport numpy as np\nimport rclpy\nfrom rclpy.node import Node\nfrom cv_bridge import CvBridge\nfrom nav_msgs.msg import Odometry\nfrom scipy.spatial.transform import Rotation\n\nbridge = CvBridge()\nodom = [0,0,0]\n\n# ros2 node class\nclass OdometerSubscriber(Node):\n\n    def __init__(self, topic):\n\n        super().__init__('odometer_subscriber')\n\n        self.subscription = self.create_subscription(\n            Odometry, topic, self.callback, 10)\n\n        self.subscription  # prevent unused variable warning\n\n\n    def callback(self, msg):\n\n        global odom\n        odom[0] = msg.pose.position.x\n        odom[1] = msg.pose.position.y\n        odom[2] = (Rotation.from_quat([msg.pose.orientation.x, msg.pose.orientation.y, msg.pose.orientation.z, msg.pose.orientation.w]))[2]\n\n\n\ndef main(inputs, outputs, parameters, synchronise):\n    \n    global odom\n\n    auto_enable = False\n    try:\n        enable = inputs.read_number('Enable')\n    except Exception:\n        auto_enable = True\n\n    rclpy.init()\n    odom_subscriber = OdometerSubscriber(parameters.read_string(\"ROSTopic\"))\n\n    try:\n        while auto_enable or inputs.read_number('Enable'):\n            measure = None\n            rclpy.spin_once(odom_subscriber)\n\n            if measure is not None:\n                outputs.share_number(\"X-Y-Yaw\",odom)\n\n            synchronise()  \n    except Exception as e:\n        print('Error:', e)\n        pass\n    finally:\n        print(\"Exiting\")\n        synchronise()     \n        odom_subscriber.destroy_node()\n        rclpy.shutdown()\n","frequency":"30","params":[{"name":"ROSTopic"}],"ports":{"in":[{"name":"Enable"}],"out":[{"name":"X-Y-Yaw"}]},"size":{"width":"300px","height":"300px"}}},"db0cd39e-e53a-4579-95f7-b652803a8bab":{"id":"db0cd39e-e53a-4579-95f7-b652803a8bab","type":"basic.output","selected":false,"x":1444,"y":414,"ports":[{"id":"c68d9144-0e42-4725-baab-ab9ce7cef65d","type":"port.input","x":1445,"y":433,"name":"output-in","alignment":"left","parentNode":"db0cd39e-e53a-4579-95f7-b652803a8bab","links":["a613f538-eabd-40f1-bb88-ebd101562443"],"in":true,"label":"output-in","hideLabel":true}],"data":{"name":"X-Y-Yaw"}}}}]},"version":"3.0","package":{"name":"Odometer","version":"2.0.0","description":"Returns a Pose Message with the Robot's Position","author":"Muhammad Taha Suhail, Toshan Luktuke","image":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/Pg0KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDE5LjAuMCwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPg0KPHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJDYXBhXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4Ig0KCSB2aWV3Qm94PSIwIDAgMzY4IDM2OCIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgMzY4IDM2ODsiIHhtbDpzcGFjZT0icHJlc2VydmUiPg0KPHBhdGggc3R5bGU9ImZpbGw6I0NDRTRGRjsiIGQ9Ik0xODQsOGM5Ny4yLDAsMTc2LDc4LjgsMTc2LDE3NnMtNzguOCwxNzYtMTc2LDE3NlM4LDI4MS4yLDgsMTg0Uzg2LjgsOCwxODQsOHogTTI5NC44OCwyNDgNCgljMTAuODgtMTguOCwxNy4xMi00MC42NCwxNy4xMi02NGMwLTcwLjcyLTU3LjI4LTEyOC0xMjgtMTI4UzU2LDExMy4yOCw1NiwxODRjMCwyMy4zNiw2LjI0LDQ1LjIsMTcuMTIsNjQNCgljMjIuMDgsMzguMjQsNjMuNTIsNjQsMTEwLjg4LDY0UzI3Mi44LDI4Ni4yNCwyOTQuODgsMjQ4eiIvPg0KPGc+DQoJPHBhdGggc3R5bGU9ImZpbGw6IzAwN0FGRjsiIGQ9Ik0xODQsMEM4Mi41NDQsMCwwLDgyLjU0NCwwLDE4NHM4Mi41NDQsMTg0LDE4NCwxODRzMTg0LTgyLjU0NCwxODQtMTg0UzI4NS40NTYsMCwxODQsMHogTTE4NCwzNTINCgkJYy05Mi42NCwwLTE2OC03NS4zNi0xNjgtMTY4UzkxLjM2LDE2LDE4NCwxNnMxNjgsNzUuMzYsMTY4LDE2OFMyNzYuNjQsMzUyLDE4NCwzNTJ6Ii8+DQoJPHBhdGggc3R5bGU9ImZpbGw6IzAwN0FGRjsiIGQ9Ik0yODAuMTM2LDg3Ljg2NGMtMC4wMzItMC4wMzItMC4wOC0wLjA0LTAuMTEyLTAuMDcyQzI1NS40MDgsNjMuMjE2LDIyMS40NDgsNDgsMTg0LDQ4DQoJCXMtNzEuNDA4LDE1LjIxNi05Ni4wMjQsMzkuNzg0Yy0wLjAzMiwwLjAzMi0wLjA4LDAuMDQtMC4xMTIsMC4wNzJzLTAuMDQsMC4wOC0wLjA3MiwwLjExMkM2My4yMTYsMTEyLjU5Miw0OCwxNDYuNTUyLDQ4LDE4NA0KCQljMCwyMy45Miw2LjI4OCw0Ny40MjQsMTguMTg0LDY3Ljk4NGMwLDAuMDA4LDAsMC4wMTYsMC4wMDgsMC4wMTZjMjQuMjE2LDQxLjk0NCw2OS4zNiw2OCwxMTcuODA4LDY4czkzLjU5Mi0yNi4wNTYsMTE3LjgwOC02OA0KCQljMC0wLjAwOCwwLTAuMDE2LDAuMDA4LTAuMDE2QzMxMy43MTIsMjMxLjQyNCwzMjAsMjA3LjkyLDMyMCwxODRjMC0zNy40NDgtMTUuMjE2LTcxLjQwOC0zOS43ODQtOTYuMDI0DQoJCUMyODAuMTc2LDg3Ljk0NCwyODAuMTY4LDg3Ljg5NiwyODAuMTM2LDg3Ljg2NHogTTI2NCwxOTJoMzkuNTEyYy0xLjEyLDE2Ljc5Mi01LjUyOCwzMy4xOTItMTMuMzUyLDQ4SDc3LjgzMg0KCQljLTcuODI0LTE0LjgwOC0xMi4yMzItMzEuMjA4LTEzLjM1Mi00OEgxMDRjNC40MTYsMCw4LTMuNTg0LDgtOHMtMy41ODQtOC04LThINjQuNDA4YzEuOC0yNy4wNjQsMTIuNTUyLTUxLjY1NiwyOS4zOTItNzAuODg4DQoJCWwyNy45ODQsMjcuOTg0YzEuNTYsMS41NiwzLjYwOCwyLjM0NCw1LjY1NiwyLjM0NHM0LjA5Ni0wLjc4NCw1LjY1Ni0yLjM0NGMzLjEyOC0zLjEyOCwzLjEyOC04LjE4NCwwLTExLjMxMkwxMDUuMTEyLDkzLjgNCgkJQzEyNC4zNDQsNzYuOTYsMTQ4LjkzNiw2Ni4yLDE3Niw2NC40MDhWMTA0YzAsNC40MTYsMy41ODQsOCw4LDhzOC0zLjU4NCw4LThWNjQuNDA4YzI3LjA2NCwxLjgsNTEuNjU2LDEyLjU1Miw3MC44ODgsMjkuMzkyDQoJCWwtNjguNiw2OC42Yy0zLjE2OC0xLjUyLTYuNjQtMi40LTEwLjI4OC0yLjRjLTEzLjIzMiwwLTI0LDEwLjc2OC0yNCwyNHMxMC43NjgsMjQsMjQsMjRzMjQtMTAuNzY4LDI0LTI0DQoJCWMwLTMuNjY0LTAuODg4LTcuMTQ0LTIuMzkyLTEwLjI5Nmw2OC41OTItNjguNTkyYzE2Ljg0LDE5LjIzMiwyNy42LDQzLjgyNCwyOS4zOTIsNzAuODg4SDI2NGMtNC40MTYsMC04LDMuNTg0LTgsOA0KCQlDMjU2LDE4OC40MTYsMjU5LjU4NCwxOTIsMjY0LDE5MnogTTE3OC4wODgsMTg5LjI3MmMtMC41OTItMC42NjQtMS4xMi0xLjM3Ni0xLjQ2NC0yLjIwOA0KCQlDMTc2Ljk1MiwxODcuODY0LDE3Ny40OCwxODguNTkyLDE3OC4wODgsMTg5LjI3MnogTTE3Ni42MTYsMTgwLjkzNmMwLjM0NC0wLjgzMiwwLjg4LTEuNTQ0LDEuNDY0LTIuMjA4DQoJCUMxNzcuNDgsMTc5LjQwOCwxNzYuOTUyLDE4MC4xMzYsMTc2LjYxNiwxODAuOTM2eiBNMTgwLjkzNiwxOTEuMzg0Yy0wLjgzMi0wLjM0NC0xLjU0NC0wLjg4LTIuMjA4LTEuNDY0DQoJCUMxNzkuNDA4LDE5MC41MiwxODAuMTM2LDE5MS4wNDgsMTgwLjkzNiwxOTEuMzg0eiBNMTg5LjI3MiwxODkuOTEyYy0wLjY2NCwwLjU5Mi0xLjM3NiwxLjEyLTIuMjA4LDEuNDY0DQoJCUMxODcuODY0LDE5MS4wNDgsMTg4LjU5MiwxOTAuNTIsMTg5LjI3MiwxODkuOTEyeiBNMTg0LDMwNGMtMzcuOTA0LDAtNzMuNDg4LTE4LjEwNC05NS45NjgtNDhoMTkxLjkzNg0KCQlDMjU3LjQ4OCwyODUuODk2LDIyMS45MDQsMzA0LDE4NCwzMDR6Ii8+DQo8L2c+DQo8Zz4NCjwvZz4NCjxnPg0KPC9nPg0KPGc+DQo8L2c+DQo8Zz4NCjwvZz4NCjxnPg0KPC9nPg0KPGc+DQo8L2c+DQo8Zz4NCjwvZz4NCjxnPg0KPC9nPg0KPGc+DQo8L2c+DQo8Zz4NCjwvZz4NCjxnPg0KPC9nPg0KPGc+DQo8L2c+DQo8Zz4NCjwvZz4NCjxnPg0KPC9nPg0KPGc+DQo8L2c+DQo8L3N2Zz4NCg=="},"design":{"board":"Python3-Noetic","graph":{"blocks":[{"id":"9642adda-63d5-4e10-b22a-f05baea64a25","type":"basic.input","data":{"name":"Enable"},"position":{"x":295,"y":537}},{"id":"0005-1ef4ad68-5036-4b35-8f12-a38ac993841e","type":"basic.constant","data":{"name":"ROSTopic","value":"/odom","local":true},"position":{"x":840,"y":25}},{"id":"66671773-167a-418d-b882-2abe13d1c849","type":"basic.code","data":{"code":"#!/usr/bin/env python3\n\nimport numpy as np\nimport rclpy\nfrom rclpy.node import Node\nfrom cv_bridge import CvBridge\nfrom nav_msgs.msg import Odometry\nfrom scipy.spatial.transform import Rotation\n\nbridge = CvBridge()\nodom = [0,0,0]\n\n# ros2 node class\nclass OdometerSubscriber(Node):\n\n    def __init__(self, topic):\n\n        super().__init__('odometer_subscriber')\n\n        self.subscription = self.create_subscription(\n            Odometry, topic, self.callback, 10)\n\n        self.subscription  # prevent unused variable warning\n\n\n    def callback(self, msg):\n\n        global odom\n        odom[0] = msg.pose.position.x\n        odom[1] = msg.pose.position.y\n        odom[2] = (Rotation.from_quat([msg.pose.orientation.x, msg.pose.orientation.y, msg.pose.orientation.z, msg.pose.orientation.w]))[2]\n\n\n\ndef main(inputs, outputs, parameters, synchronise):\n    \n    global odom\n\n    auto_enable = False\n    try:\n        enable = inputs.read_number('Enable')\n    except Exception:\n        auto_enable = True\n\n    rclpy.init()\n    odom_subscriber = OdometerSubscriber(parameters.read_string(\"ROSTopic\"))\n\n    try:\n        while auto_enable or inputs.read_number('Enable'):\n            measure = None\n            rclpy.spin_once(odom_subscriber)\n\n            if measure is not None:\n                outputs.share_number(\"X-Y-Yaw\",odom)\n\n            synchronise()  \n    except Exception as e:\n        print('Error:', e)\n        pass\n    finally:\n        print(\"Exiting\")\n        synchronise()     \n        odom_subscriber.destroy_node()\n        rclpy.shutdown()\n","frequency":"30","params":[{"name":"ROSTopic"}],"ports":{"in":[{"name":"Enable"}],"out":[{"name":"X-Y-Yaw"}]},"size":{"width":"300px","height":"300px"}},"position":{"x":547,"y":235}},{"id":"db0cd39e-e53a-4579-95f7-b652803a8bab","type":"basic.output","data":{"name":"X-Y-Yaw"},"position":{"x":1444,"y":414}}],"wires":[{"source":{"block":"9642adda-63d5-4e10-b22a-f05baea64a25","port":"input-out","name":"Enable"},"target":{"block":"66671773-167a-418d-b882-2abe13d1c849","port":"Enable","name":"Enable"}},{"source":{"block":"0005-1ef4ad68-5036-4b35-8f12-a38ac993841e","port":"constant-out","name":"ROSTopic"},"target":{"block":"66671773-167a-418d-b882-2abe13d1c849","port":"ROSTopic","name":"ROSTopic"}},{"source":{"block":"66671773-167a-418d-b882-2abe13d1c849","port":"X-Y-Yaw","name":"X-Y-Yaw"},"target":{"block":"db0cd39e-e53a-4579-95f7-b652803a8bab","port":"output-in","name":"output-in"}}]}},"dependencies":{}}