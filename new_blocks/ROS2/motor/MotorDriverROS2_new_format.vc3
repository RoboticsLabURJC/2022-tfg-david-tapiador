{"editor":{"id":"bb24521a-8c41-4f55-8e96-b7aff41c4297","locked":true,"offsetX":-3,"offsetY":-4,"zoom":100,"gridSize":0,"layers":[{"id":"50937002-f39a-4d49-a9eb-39771635497f","type":"diagram-links","isSvg":true,"transformed":true,"models":{"e0133af2-cd89-4779-bbc5-6ec32a76f6cf":{"id":"e0133af2-cd89-4779-bbc5-6ec32a76f6cf","type":"default","selected":false,"source":"0002-cb4c125e-14b6-4322-b252-35d2817b2832","sourcePort":"c76ea7fc-9390-4252-bcaa-01bd0afe7bfd","target":"e30b0381-02bd-4ba1-9748-c60c4f7bd89d","targetPort":"2c658abd-a851-4854-9a88-4b2123d24be0","points":[{"id":"02d16dd7-25c4-4dce-9399-a858dff2f3ca","type":"point","x":827,"y":141.5},{"id":"969bcabe-750c-4528-90ce-33cf34e1a625","type":"point","x":849.984375,"y":288.5}],"labels":[],"width":3,"color":"gray","curvyness":50,"selectedColor":"rgb(0,192,255)"},"e1d49e8f-6c2f-4ef5-9050-f04faac3d2c3":{"id":"e1d49e8f-6c2f-4ef5-9050-f04faac3d2c3","type":"default","selected":false,"source":"78669ed1-e751-4ec8-ae57-b87a640feb4b","sourcePort":"80c09fc1-951c-412b-8395-f298f56faf68","target":"e30b0381-02bd-4ba1-9748-c60c4f7bd89d","targetPort":"94996371-d14e-4324-bac4-084eb05cd00b","points":[{"id":"fbd0a912-20fe-4426-9de8-aa48cb2c3236","type":"point","x":192.5,"y":364.5},{"id":"9d266321-785c-4141-925a-87282954f5a3","type":"point","x":403.5,"y":340.5}],"labels":[],"width":3,"color":"gray","curvyness":50,"selectedColor":"rgb(0,192,255)"},"918f8814-00eb-4d31-a170-3b1b8aa7ea63":{"id":"918f8814-00eb-4d31-a170-3b1b8aa7ea63","type":"default","selected":false,"source":"a0f07e9e-bd5e-4295-a3a2-5690fa4568ba","sourcePort":"a23d135a-c5ad-4eac-8978-9c8fdae27da3","target":"e30b0381-02bd-4ba1-9748-c60c4f7bd89d","targetPort":"1b0aded6-5cf9-487c-8cb7-a3f3dc0de2bd","points":[{"id":"ed6e0531-50a0-4211-b668-323f96370dc8","type":"point","x":188.5,"y":258.5},{"id":"bf583f2d-4642-4d14-ac49-17c0afddb9a8","type":"point","x":403.5,"y":314.5}],"labels":[],"width":3,"color":"gray","curvyness":50,"selectedColor":"rgb(0,192,255)"}}},{"id":"220b70ae-199a-4bc2-8a5d-05e7ec6ae5ca","type":"diagram-nodes","isSvg":false,"transformed":true,"models":{"0002-cb4c125e-14b6-4322-b252-35d2817b2832":{"id":"0002-cb4c125e-14b6-4322-b252-35d2817b2832","type":"basic.constant","selected":false,"x":766,"y":26,"ports":[{"id":"c76ea7fc-9390-4252-bcaa-01bd0afe7bfd","type":"port.output","x":819.5,"y":134,"name":"constant-out","alignment":"bottom","parentNode":"0002-cb4c125e-14b6-4322-b252-35d2817b2832","links":["e0133af2-cd89-4779-bbc5-6ec32a76f6cf"],"in":false,"label":"constant-out","hideLabel":true}],"data":{"name":"ROS Topic","value":"/cmd_vel","local":true}},"e30b0381-02bd-4ba1-9748-c60c4f7bd89d":{"id":"e30b0381-02bd-4ba1-9748-c60c4f7bd89d","type":"basic.code","selected":false,"x":395,"y":211,"ports":[{"id":"1b0aded6-5cf9-487c-8cb7-a3f3dc0de2bd","type":"port.input","x":396,"y":307,"name":"Vels","alignment":"left","parentNode":"e30b0381-02bd-4ba1-9748-c60c4f7bd89d","links":["918f8814-00eb-4d31-a170-3b1b8aa7ea63"],"in":true,"label":"Vels","hideLabel":false},{"id":"94996371-d14e-4324-bac4-084eb05cd00b","type":"port.input","x":396,"y":333,"name":"Enable","alignment":"left","parentNode":"e30b0381-02bd-4ba1-9748-c60c4f7bd89d","links":["e1d49e8f-6c2f-4ef5-9050-f04faac3d2c3"],"in":true,"label":"Enable","hideLabel":false},{"id":"2c658abd-a851-4854-9a88-4b2123d24be0","type":"port.parameter","x":842.484375,"y":281,"name":"ROS Topic","alignment":"top","parentNode":"e30b0381-02bd-4ba1-9748-c60c4f7bd89d","links":["e0133af2-cd89-4779-bbc5-6ec32a76f6cf"],"in":true,"label":"ROS Topic","hideLabel":false}],"data":{"code":"#!/usr/bin/env python3\n\nimport numpy as np\n\nimport rclpy\nfrom rclpy.node import Node\nfrom cv_bridge import CvBridge\nfrom geometry_msgs.msg import Twist\n\nbridge = CvBridge()\nvelocities = 0\n\n# ros2 node class\nclass VelPublisher(Node):\n\n    def __init__(self, topic):\n        super().__init__('vel_publisher')\n        self.publisher_ = self.create_publisher(Twist, topic, 1)\n        timer_period = 0.5  # seconds\n        self.timer = self.create_timer(timer_period, self.timer_callback)\n\n    def timer_callback(self):\n        global velocities\n        msg = Twist()\n        \n        try:\n            msg.linear.x = float(velocities[0])\n            msg.linear.y = float(velocities[1])\n            msg.linear.z = float(velocities[2])\n            msg.angular.x = float(velocities[3])\n            msg.angular.y = float(velocities[4])\n            msg.angular.z = float(velocities[5])\n        except IndexError:\n            print(\"bad length for input array\")\n            return\n        self.publisher_.publish(msg)\n\n\n\ndef main(inputs, outputs, parameters, synchronise):\n    \n    global velocities\n\n    auto_enable = False\n    try:\n        enable = inputs.read_number('Enable')\n    except Exception:\n        auto_enable = True\n\n    rclpy.init()\n    vel_publisher = VelPublisher(parameters.read_string('ROS Topic'))\n\n    try:\n\n        while auto_enable or inputs.read_number('Enable'):\n\n            velocities = inputs.read_array('Vels')\n            if velocities.size != 0:\n                rclpy.spin_once(vel_publisher) \n            synchronise()   \n    \n    except KeyboardInterrupt:\n\n        vel_publisher.destroy_node()\n        rclpy.shutdown()\n","frequency":"30","params":[{"name":"ROS Topic"}],"ports":{"in":[{"name":"Vels"},{"name":"Enable"}],"out":[]},"size":{"width":"858px","height":"19px"}}},"a0f07e9e-bd5e-4295-a3a2-5690fa4568ba":{"id":"a0f07e9e-bd5e-4295-a3a2-5690fa4568ba","type":"basic.input","selected":false,"x":95,"y":232,"ports":[{"id":"a23d135a-c5ad-4eac-8978-9c8fdae27da3","type":"port.output","x":181,"y":251,"name":"input-out","alignment":"right","parentNode":"a0f07e9e-bd5e-4295-a3a2-5690fa4568ba","links":["918f8814-00eb-4d31-a170-3b1b8aa7ea63"],"in":false,"label":"Vels","hideLabel":true}],"data":{"name":"Vels"}},"78669ed1-e751-4ec8-ae57-b87a640feb4b":{"id":"78669ed1-e751-4ec8-ae57-b87a640feb4b","type":"basic.input","selected":false,"x":99,"y":338,"ports":[{"id":"80c09fc1-951c-412b-8395-f298f56faf68","type":"port.output","x":185,"y":357,"name":"input-out","alignment":"right","parentNode":"78669ed1-e751-4ec8-ae57-b87a640feb4b","links":["e1d49e8f-6c2f-4ef5-9050-f04faac3d2c3"],"in":false,"label":"Enable","hideLabel":true}],"data":{"name":"Enable"}}}}]},"version":"3.0","package":{"name":"MotorDriver","version":"1.0.0","description":"Controls Robot's Movement.","author":"Muhammad Taha Suhail","image":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIj8+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBpZD0iTGF5ZXJfMSIgZGF0YS1uYW1lPSJMYXllciAxIiB2aWV3Qm94PSIwIDAgMTI4IDEyOCIgd2lkdGg9IjUxMiIgaGVpZ2h0PSI1MTIiPjx0aXRsZT5NT1RPUiBEQzwvdGl0bGU+PHBhdGggZD0iTTU0LjQ2OSwzNC42MjVINzQuNjNhNy4yOTQsNy4yOTQsMCwwLDEsNy4yOTQsNy4yOTRWNTJhMCwwLDAsMCwxLDAsMEg0Ny4xNzVhMCwwLDAsMCwxLDAsMFY0MS45MTlBNy4yOTQsNy4yOTQsMCwwLDEsNTQuNDY5LDM0LjYyNVoiIHN0eWxlPSJmaWxsOiNiYWRkZmEiLz48cGF0aCBkPSJNODAuNDI1LDUySDQ4LjY3NVY3Mi4xOTFBNC4wNzYsNC4wNzYsMCwwLDAsNTEuMyw3NmgwYTQuMDc2LDQuMDc2LDAsMCwxLDIuNjI1LDMuODA5VjgwLjVoMjEuMjV2LS42OTFBNC4wNzYsNC4wNzYsMCwwLDEsNzcuOCw3NmgwYTQuMDc2LDQuMDc2LDAsMCwwLDIuNjI1LTMuODA5WiIgc3R5bGU9ImZpbGw6I2ZmZiIvPjxyZWN0IHg9IjYxLjExMiIgeT0iODYuNSIgd2lkdGg9IjYuODc1IiBoZWlnaHQ9IjYuODc1IiBzdHlsZT0iZmlsbDojYmFkZGZhIi8+PHBhdGggZD0iTTc0LjYzLDMzLjUyNUg1NC40NjlhOC40LDguNCwwLDAsMC04LjM5NCw4LjM5NVY1MmExLjEsMS4xLDAsMCwwLDEuMSwxLjFoLjRWNzIuMTkxYTUuMjA2LDUuMjA2LDAsMCwwLDMuMzMzLDQuODM3LDIuOTkxLDIuOTkxLDAsMCwxLDEuOTE2LDIuNzhWODAuNWExLjEsMS4xLDAsMCwwLDEuMSwxLjFINjMuNDV2My44SDYxLjExMmExLjEsMS4xLDAsMCwwLTEuMSwxLjF2Ni44NzVhMS4xLDEuMSwwLDAsMCwxLjEsMS4xaDYuODc1YTEuMSwxLjEsMCwwLDAsMS4xLTEuMVY4Ni41YTEuMSwxLjEsMCwwLDAtMS4xLTEuMUg2NS42NVY4MS42aDkuNTI1YTEuMSwxLjEsMCwwLDAsMS4xLTEuMXYtLjY5MWEyLjk5MSwyLjk5MSwwLDAsMSwxLjkxNi0yLjc4LDUuMjA2LDUuMjA2LDAsMCwwLDMuMzMzLTQuODM3VjUzLjFoLjRhMS4xLDEuMSwwLDAsMCwxLjEtMS4xVjQxLjkyQTguNCw4LjQsMCwwLDAsNzQuNjMsMzMuNTI1Wm0tNy43NDMsNTguNzVINjIuMjEyVjg3LjZoNC42NzVaTTQ4LjI3NSw0MS45MmE2LjIsNi4yLDAsMCwxLDYuMTk0LTYuMkg3NC42M2E2LjIsNi4yLDAsMCwxLDYuMTk0LDYuMlY1MC45SDQ4LjI3NVptMzEuMDUsMzAuMjcyYTIuOTkxLDIuOTkxLDAsMCwxLTEuOTE2LDIuNzhBNS4yMSw1LjIxLDAsMCwwLDc0LjA5MSw3OS40SDU1LjAwOGE1LjIxLDUuMjEsMCwwLDAtMy4zMTctNC40MjksMi45OTEsMi45OTEsMCwwLDEtMS45MTYtMi43OFY1My4xaDI5LjU1WiIgc3R5bGU9ImZpbGw6IzM5NDlhYSIvPjxwYXRoIGQ9Ik01Ny44LDcxLjZhMS4xLDEuMSwwLDAsMCwxLjEtMS4xVjU4Ljc1YTEuMSwxLjEsMCwwLDAtMi4yLDBWNzAuNUExLjEsMS4xLDAsMCwwLDU3LjgsNzEuNloiIHN0eWxlPSJmaWxsOiMzOTQ5YWEiLz48cGF0aCBkPSJNNjQuNTUsNzEuNmExLjEsMS4xLDAsMCwwLDEuMS0xLjFWNTguNzVhMS4xLDEuMSwwLDAsMC0yLjIsMFY3MC41QTEuMSwxLjEsMCwwLDAsNjQuNTUsNzEuNloiIHN0eWxlPSJmaWxsOiMzOTQ5YWEiLz48cGF0aCBkPSJNNzEuMyw3MS42YTEuMSwxLjEsMCwwLDAsMS4xLTEuMVY1OC43NWExLjEsMS4xLDAsMCwwLTIuMiwwVjcwLjVBMS4xLDEuMSwwLDAsMCw3MS4zLDcxLjZaIiBzdHlsZT0iZmlsbDojMzk0OWFhIi8+PC9zdmc+Cg=="},"design":{"board":"Python3-Noetic","graph":{"blocks":[{"id":"0002-cb4c125e-14b6-4322-b252-35d2817b2832","type":"basic.constant","data":{"name":"ROS Topic","value":"/cmd_vel","local":true},"position":{"x":766,"y":26}},{"id":"e30b0381-02bd-4ba1-9748-c60c4f7bd89d","type":"basic.code","data":{"code":"#!/usr/bin/env python3\n\nimport numpy as np\n\nimport rclpy\nfrom rclpy.node import Node\nfrom cv_bridge import CvBridge\nfrom geometry_msgs.msg import Twist\n\nbridge = CvBridge()\nvelocities = 0\n\n# ros2 node class\nclass VelPublisher(Node):\n\n    def __init__(self, topic):\n        super().__init__('vel_publisher')\n        self.publisher_ = self.create_publisher(Twist, topic, 1)\n        timer_period = 0.5  # seconds\n        self.timer = self.create_timer(timer_period, self.timer_callback)\n\n    def timer_callback(self):\n        global velocities\n        msg = Twist()\n        \n        try:\n            msg.linear.x = float(velocities[0])\n            msg.linear.y = float(velocities[1])\n            msg.linear.z = float(velocities[2])\n            msg.angular.x = float(velocities[3])\n            msg.angular.y = float(velocities[4])\n            msg.angular.z = float(velocities[5])\n        except IndexError:\n            print(\"bad length for input array\")\n            return\n        self.publisher_.publish(msg)\n\n\n\ndef main(inputs, outputs, parameters, synchronise):\n    \n    global velocities\n\n    auto_enable = False\n    try:\n        enable = inputs.read_number('Enable')\n    except Exception:\n        auto_enable = True\n\n    rclpy.init()\n    vel_publisher = VelPublisher(parameters.read_string('ROS Topic'))\n\n    try:\n\n        while auto_enable or inputs.read_number('Enable'):\n\n            velocities = inputs.read_array('Vels')\n            if velocities.size != 0:\n                rclpy.spin_once(vel_publisher) \n            synchronise()   \n    \n    except KeyboardInterrupt:\n\n        vel_publisher.destroy_node()\n        rclpy.shutdown()\n","frequency":"30","params":[{"name":"ROS Topic"}],"ports":{"in":[{"name":"Vels"},{"name":"Enable"}],"out":[]},"size":{"width":"858px","height":"19px"}},"position":{"x":395,"y":211}},{"id":"a0f07e9e-bd5e-4295-a3a2-5690fa4568ba","type":"basic.input","data":{"name":"Vels"},"position":{"x":95,"y":232}},{"id":"78669ed1-e751-4ec8-ae57-b87a640feb4b","type":"basic.input","data":{"name":"Enable"},"position":{"x":99,"y":338}}],"wires":[{"source":{"block":"0002-cb4c125e-14b6-4322-b252-35d2817b2832","port":"constant-out","name":"constant-out"},"target":{"block":"e30b0381-02bd-4ba1-9748-c60c4f7bd89d","port":"ROS Topic","name":"ROS Topic"}},{"source":{"block":"78669ed1-e751-4ec8-ae57-b87a640feb4b","port":"input-out","name":"Enable"},"target":{"block":"e30b0381-02bd-4ba1-9748-c60c4f7bd89d","port":"Enable","name":"Enable"}},{"source":{"block":"a0f07e9e-bd5e-4295-a3a2-5690fa4568ba","port":"input-out","name":"Vels"},"target":{"block":"e30b0381-02bd-4ba1-9748-c60c4f7bd89d","port":"Vels","name":"Vels"}}]}},"dependencies":{}}