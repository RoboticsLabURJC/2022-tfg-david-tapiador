{"editor":{"id":"f2c89810-a9ca-49a6-9aaa-aff923b71c24","locked":true,"offsetX":0,"offsetY":0,"zoom":100,"gridSize":0,"layers":[{"id":"1e8d9a20-c0fa-49ac-bf8f-e419eaf70280","type":"diagram-links","isSvg":true,"transformed":true,"models":{"4d9dcf9b-23ce-4115-a3a5-c4f36a6c0aa1":{"id":"4d9dcf9b-23ce-4115-a3a5-c4f36a6c0aa1","type":"default","selected":false,"source":"0003-6d18c1e5-68e8-4d33-b004-b4143f3a348f","sourcePort":"9d70cae5-6fc2-47be-8b00-d0d2f22e4ee1","target":"0469571f-9774-47d4-8b6f-f1facd8f21a3","targetPort":"1cec8e72-5a47-46ab-aa46-419204595842","points":[{"id":"9f862a8d-73d6-47ba-bb91-a5e389bd502d","type":"point","x":1031,"y":127.5},{"id":"fb85a3ab-19bc-4bc6-8c1a-65f8657408bb","type":"point","x":1018.3125,"y":264.5}],"labels":[],"width":3,"color":"gray","curvyness":50,"selectedColor":"rgb(0,192,255)"},"1ebcc625-3a20-491f-ba0f-d2a22f621b54":{"id":"1ebcc625-3a20-491f-ba0f-d2a22f621b54","type":"default","selected":false,"source":"0469571f-9774-47d4-8b6f-f1facd8f21a3","sourcePort":"d2c05f1c-cc70-4478-8fb2-e08ff12afe2f","target":"a79c1b0c-fbe7-4a52-9c34-092589429d9d","targetPort":"71d8c685-aacb-4f69-a283-c58fde872d90","points":[{"id":"67427f60-36f8-4160-8cd1-9a90c604d359","type":"point","x":611.5,"y":297},{"id":"74e51693-268c-4494-bb10-2f96a0634ebb","type":"point","selected":true,"x":462.5,"y":440.5}],"labels":[],"width":3,"color":"gray","curvyness":50,"selectedColor":"rgb(0,192,255)"},"3a8a4e39-5746-4d8a-a94e-09002db0517d":{"id":"3a8a4e39-5746-4d8a-a94e-09002db0517d","type":"default","selected":false,"source":"0469571f-9774-47d4-8b6f-f1facd8f21a3","sourcePort":"eb1da235-966d-4599-8b15-b485a3cc4a34","target":"084fa400-4f86-42a9-bd49-3f774042bc14","targetPort":"a9c76aec-5e15-416e-bfc6-bb9f5b450aec","points":[{"id":"f9ad46b5-f2db-4ed2-bf60-2013e9db3d5b","type":"point","x":1425.15625,"y":297},{"id":"81c61b78-a2be-4f46-aa01-d297e37101b1","type":"point","x":1574.5,"y":480.5}],"labels":[],"width":3,"color":"gray","curvyness":50,"selectedColor":"rgb(0,192,255)"}}},{"id":"fcac3d46-b46f-4b24-9e41-e729de31940e","type":"diagram-nodes","isSvg":false,"transformed":true,"models":{"0469571f-9774-47d4-8b6f-f1facd8f21a3":{"id":"0469571f-9774-47d4-8b6f-f1facd8f21a3","type":"basic.code","selected":false,"x":603,"y":187,"ports":[{"id":"d2c05f1c-cc70-4478-8fb2-e08ff12afe2f","type":"port.input","x":604,"y":289.5,"name":"Enable","alignment":"left","parentNode":"0469571f-9774-47d4-8b6f-f1facd8f21a3","links":["1ebcc625-3a20-491f-ba0f-d2a22f621b54"],"in":true,"label":"Enable","hideLabel":false},{"id":"eb1da235-966d-4599-8b15-b485a3cc4a34","type":"port.output","x":1417.65625,"y":289.5,"name":"Laser","alignment":"right","parentNode":"0469571f-9774-47d4-8b6f-f1facd8f21a3","links":["3a8a4e39-5746-4d8a-a94e-09002db0517d"],"in":false,"label":"Laser","hideLabel":false},{"id":"1cec8e72-5a47-46ab-aa46-419204595842","type":"port.parameter","x":1010.8125,"y":257,"name":"ROS Topic","alignment":"top","parentNode":"0469571f-9774-47d4-8b6f-f1facd8f21a3","links":["4d9dcf9b-23ce-4115-a3a5-c4f36a6c0aa1"],"in":true,"label":"ROS Topic","hideLabel":false}],"data":{"code":"#!/usr/bin/env python3\n\nimport numpy as np\nimport rclpy\nfrom rclpy.node import Node\nfrom cv_bridge import CvBridge\nfrom sensor_msgs.msg import LaserScan\n\nbridge = CvBridge()\nmeasure = None\n\n# ros2 node class\nclass LaserSubscriber(Node):\n\n    def __init__(self, topic):\n\n        super().__init__('laser_subscriber')\n\n        self.subscription = self.create_subscription(\n            LaserScan, topic, self.callback, 10)\n\n        self.subscription  # prevent unused variable warning\n\n\n    def callback(self, msg):\n\n        global measure\n\n        measure = []\n        for i in range(len(msg.ranges)):\n            measure.extend((str(msg.ranges[i]),))\n\n\n\ndef main(inputs, outputs, parameters, synchronise):\n    \n    global measure\n\n    auto_enable = False\n    try:\n        enable = inputs.read_number('Enable')\n    except Exception:\n        auto_enable = True\n\n    rclpy.init()\n    laser_subscriber = LaserSubscriber(parameters.read_string(\"ROS Topic\"))\n\n    try:\n        while auto_enable or inputs.read_number('Enable'):\n            measure = None\n            rclpy.spin_once(laser_subscriber)\n\n            if measure is not None:\n                outputs.share_array(\"Laser\",measure)   \n\n            synchronise()  \n    except Exception as e:\n        print('Error:', e)\n        pass\n    finally:\n        print(\"Exiting\")\n        synchronise()     \n        laser_subscriber.destroy_node()\n        rclpy.shutdown()\n","frequency":"30","params":[{"name":"ROS Topic"}],"ports":{"in":[{"name":"Enable"}],"out":[{"name":"Laser"}]},"size":{"width":"754px","height":"19px"}}},"0003-6d18c1e5-68e8-4d33-b004-b4143f3a348f":{"id":"0003-6d18c1e5-68e8-4d33-b004-b4143f3a348f","type":"basic.constant","selected":true,"x":969,"y":11,"ports":[{"id":"9d70cae5-6fc2-47be-8b00-d0d2f22e4ee1","type":"port.output","x":1023.5,"y":120,"name":"constant-out","alignment":"bottom","parentNode":"0003-6d18c1e5-68e8-4d33-b004-b4143f3a348f","links":["4d9dcf9b-23ce-4115-a3a5-c4f36a6c0aa1"],"in":false,"label":"ROS Topic","hideLabel":true}],"data":{"name":"ROS Topic","value":"/scan","local":true}},"a79c1b0c-fbe7-4a52-9c34-092589429d9d":{"id":"a79c1b0c-fbe7-4a52-9c34-092589429d9d","type":"basic.input","selected":false,"x":369,"y":414,"ports":[{"id":"71d8c685-aacb-4f69-a283-c58fde872d90","type":"port.output","x":455,"y":433,"name":"input-out","alignment":"right","parentNode":"a79c1b0c-fbe7-4a52-9c34-092589429d9d","links":["1ebcc625-3a20-491f-ba0f-d2a22f621b54"],"in":false,"label":"Enable","hideLabel":true}],"data":{"name":"Enable"}},"084fa400-4f86-42a9-bd49-3f774042bc14":{"id":"084fa400-4f86-42a9-bd49-3f774042bc14","type":"basic.output","selected":false,"x":1566,"y":454,"ports":[{"id":"a9c76aec-5e15-416e-bfc6-bb9f5b450aec","type":"port.input","x":1567,"y":473,"name":"output-in","alignment":"left","parentNode":"084fa400-4f86-42a9-bd49-3f774042bc14","links":["3a8a4e39-5746-4d8a-a94e-09002db0517d"],"in":true,"label":"output-in","hideLabel":true}],"data":{"name":"Laser"}}}}]},"version":"3.0","package":{"name":"","version":"","description":"","author":"","image":""},"design":{"board":"Python3-Noetic","graph":{"blocks":[{"id":"0469571f-9774-47d4-8b6f-f1facd8f21a3","type":"basic.code","data":{"code":"#!/usr/bin/env python3\n\nimport numpy as np\nimport rclpy\nfrom rclpy.node import Node\nfrom cv_bridge import CvBridge\nfrom sensor_msgs.msg import LaserScan\n\nbridge = CvBridge()\nmeasure = None\n\n# ros2 node class\nclass LaserSubscriber(Node):\n\n    def __init__(self, topic):\n\n        super().__init__('laser_subscriber')\n\n        self.subscription = self.create_subscription(\n            LaserScan, topic, self.callback, 10)\n\n        self.subscription  # prevent unused variable warning\n\n\n    def callback(self, msg):\n\n        global measure\n\n        measure = []\n        for i in range(len(msg.ranges)):\n            measure.extend((str(msg.ranges[i]),))\n\n\n\ndef main(inputs, outputs, parameters, synchronise):\n    \n    global measure\n\n    auto_enable = False\n    try:\n        enable = inputs.read_number('Enable')\n    except Exception:\n        auto_enable = True\n\n    rclpy.init()\n    laser_subscriber = LaserSubscriber(parameters.read_string(\"ROS Topic\"))\n\n    try:\n        while auto_enable or inputs.read_number('Enable'):\n            measure = None\n            rclpy.spin_once(laser_subscriber)\n\n            if measure is not None:\n                outputs.share_array(\"Laser\",measure)   \n\n            synchronise()  \n    except Exception as e:\n        print('Error:', e)\n        pass\n    finally:\n        print(\"Exiting\")\n        synchronise()     \n        laser_subscriber.destroy_node()\n        rclpy.shutdown()\n","frequency":"30","params":[{"name":"ROS Topic"}],"ports":{"in":[{"name":"Enable"}],"out":[{"name":"Laser"}]},"size":{"width":"754px","height":"19px"}},"position":{"x":603,"y":187}},{"id":"0003-6d18c1e5-68e8-4d33-b004-b4143f3a348f","type":"basic.constant","data":{"name":"ROS Topic","value":"/scan","local":true},"position":{"x":969,"y":11}},{"id":"a79c1b0c-fbe7-4a52-9c34-092589429d9d","type":"basic.input","data":{"name":"Enable"},"position":{"x":369,"y":414}},{"id":"084fa400-4f86-42a9-bd49-3f774042bc14","type":"basic.output","data":{"name":"Laser"},"position":{"x":1566,"y":454}}],"wires":[{"source":{"block":"0003-6d18c1e5-68e8-4d33-b004-b4143f3a348f","port":"constant-out","name":"ROS Topic"},"target":{"block":"0469571f-9774-47d4-8b6f-f1facd8f21a3","port":"ROS Topic","name":"ROS Topic"}},{"source":{"block":"a79c1b0c-fbe7-4a52-9c34-092589429d9d","port":"input-out","name":"Enable"},"target":{"block":"0469571f-9774-47d4-8b6f-f1facd8f21a3","port":"Enable","name":"Enable"}},{"source":{"block":"0469571f-9774-47d4-8b6f-f1facd8f21a3","port":"Laser","name":"Laser"},"target":{"block":"084fa400-4f86-42a9-bd49-3f774042bc14","port":"output-in","name":"output-in"}}]}},"dependencies":{}}